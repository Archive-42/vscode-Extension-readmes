<hr>


<center>


<img src="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/23b9b236-746e-409c-8e86-30b4385e3b72/hr1-raypham.gif" alt="hr-line" width="781" height="22">


<p>NEXT</p>


</center>


<hr>


<h1 id="sample-usage-in-node.js">Sample usage in node.js</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">const</span> cp  <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;child_process&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">const</span> rpc <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;vscode-jsonrpc/node&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">const</span> env <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-4" title="4">    <span class="dt">PYTHONUNBUFFERED</span><span class="op">:</span> <span class="st">&#39;1&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-5" title="5">    <span class="dt">PYTHONPATH</span><span class="op">:</span> <span class="st">&#39;&lt;extension dir&gt;/pythonFiles:&lt;extension dir&gt;/pythonFiles/lib/python&#39;</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="op">}</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">const</span> childProcess <span class="op">=</span> <span class="va">cp</span>.<span class="at">spawn</span>(<span class="st">&#39;&lt;fully qualifieid python path&gt;&#39;</span><span class="op">,</span> [<span class="st">&#39;-m&#39;</span><span class="op">,</span> <span class="st">&#39;vscode_datascience_helpers.daemon&#39;</span><span class="op">,</span> <span class="st">&#39;-v&#39;</span><span class="op">,</span> <span class="st">&#39;--log-file=log.log&#39;</span>]<span class="op">,</span> <span class="op">{</span>env<span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">const</span> connection <span class="op">=</span> <span class="va">rpc</span>.<span class="at">createMessageConnection</span>(<span class="kw">new</span> <span class="va">rpc</span>.<span class="at">StreamMessageReader</span>(<span class="va">childProcess</span>.<span class="at">stdout</span>)<span class="op">,</span><span class="kw">new</span> <span class="va">rpc</span>.<span class="at">StreamMessageWriter</span>(<span class="va">childProcess</span>.<span class="at">stdin</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb1-9" title="9"></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="va">connection</span>.<span class="at">onClose</span>(() <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">error</span>(<span class="st">&#39;Closed&#39;</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="va">connection</span>.<span class="at">onError</span>(ex <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">error</span>(ex))<span class="op">;</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="va">connection</span>.<span class="at">onDispose</span>(() <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">error</span>(<span class="st">&#39;disposed&#39;</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="va">connection</span>.<span class="at">onNotification</span>((e<span class="op">,</span> data) <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`Notification from daemon, such as stdout/stderr, </span><span class="sc">${</span><span class="va">JSON</span>.<span class="at">stringify</span>(data)<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="va">connection</span>.<span class="at">onUnhandledNotification</span>(e <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">error</span>(e))<span class="op">;</span></a>
<a class="sourceLine" id="cb1-15" title="15"></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="co">// Start</span></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="va">connection</span>.<span class="at">listen</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb1-18" title="18"></a>
<a class="sourceLine" id="cb1-19" title="19"><span class="kw">const</span> pingRequest <span class="op">=</span> <span class="kw">new</span> <span class="va">rpc</span>.<span class="at">RequestType</span>(<span class="st">&#39;ping&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-20" title="20"><span class="va">connection</span>.<span class="at">sendRequest</span>(pingRequest<span class="op">,</span> <span class="op">{</span><span class="dt">data</span><span class="op">:</span> <span class="st">&#39;oneâ‚¹ðŸ˜„&#39;</span><span class="op">}</span>)</a>
<a class="sourceLine" id="cb1-21" title="21">    .<span class="at">then</span>(response <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`Pong received </span><span class="sc">${</span><span class="va">JSON</span>.<span class="at">stringify</span>(response)<span class="sc">}</span><span class="vs">`</span>)<span class="op">,</span> ex <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">error</span>(ex))<span class="op">;</span></a></code></pre></div>
