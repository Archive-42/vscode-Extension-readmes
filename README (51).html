<hr>


<center>


<img src="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/23b9b236-746e-409c-8e86-30b4385e3b72/hr1-raypham.gif" alt="hr-line" width="781" height="22">


<p>NEXT</p>


</center>


<hr>


<h1 id="typeshed">typeshed</h1>
<p><a href="https://github.com/python/typeshed/actions?query=workflow%3A%22Check+stubs%22"><img src="https://github.com/python/typeshed/workflows/Check%20stubs/badge.svg" alt="Build status" /></a> <a href="https://gitter.im/python/typing?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge"><img src="https://badges.gitter.im/python/typing.svg" alt="Chat at https://gitter.im/python/typing" /></a> <a href="https://github.com/python/typeshed/blob/master/CONTRIBUTING.md"><img src="https://img.shields.io/badge/pull%20requests-welcome-brightgreen.svg" alt="Pull Requests Welcome" /></a></p>
<h2 id="about">About</h2>
<p>Typeshed contains external type annotations for the Python standard library and Python builtins, as well as third party packages as contributed by people external to those projects.</p>
<p>This data can e.g. be used for static analysis, type checking or type inference.</p>
<p>For information on how to use <code>typeshed</code>, read below. Information for contributors can be found in <a href="CONTRIBUTING.md">CONTRIBUTING.md</a>. <strong>Please read it before submitting pull requests; do not report issues with annotations to the project the stubs are for, but instead report them here to typeshed.</strong></p>
<p>Typeshed supports Python versions 2.7 and 3.6 and up.</p>
<h2 id="using">Using</h2>
<p>If you're just using mypy (or pytype or PyCharm), as opposed to developing it, you don't need to interact with the typeshed repo at all: a copy of typeshed is bundled with mypy.</p>
<p>When you use a checked-out clone of the mypy repo, a copy of typeshed should be included as a submodule, using</p>
<pre><code>$ git clone --recurse-submodules https://github.com/python/mypy.git</code></pre>
<p>or</p>
<pre><code>$ git clone https://github.com/python/mypy.git
$ cd mypy
$ git submodule init
$ git submodule update</code></pre>
<p>and occasionally you will have to repeat the final command (<code>git submodule update</code>) to pull in changes made in the upstream typeshed repo.</p>
<p>PyCharm and pytype similarly include a copy of typeshed. The one in pytype can be updated in the same way if you are working with the pytype repo.</p>
<h2 id="format">Format</h2>
<p>Each Python module is represented by a <code>.pyi</code> "stub file". This is a syntactically valid Python file, although it usually cannot be run by Python 3 (since forward references don't require string quotes). All the methods are empty.</p>
<p>Python function annotations (<a href="https://www.python.org/dev/peps/pep-3107/">PEP 3107</a>) are used to describe the signature of each function or method.</p>
<p>See <a href="http://www.python.org/dev/peps/pep-0484/">PEP 484</a> for the exact syntax of the stub files and <a href="CONTRIBUTING.md">CONTRIBUTING.md</a> for the coding style used in typeshed.</p>
<h2 id="directory-structure">Directory structure</h2>
<h3 id="stdlib">stdlib</h3>
<p>This contains stubs for modules the Python standard library – which includes pure Python modules, dynamically loaded extension modules, hard-linked extension modules, and the builtins.</p>
<h3 id="third_party">third_party</h3>
<p>Modules that are not shipped with Python but have a type description in Python go into <code>third_party</code>. Since these modules can behave differently for different versions of Python, <code>third_party</code> has version subdirectories, just like <code>stdlib</code>.</p>
<p>For more information on directory structure and stub versioning, see <a href="https://github.com/python/typeshed/blob/master/CONTRIBUTING.md#stub-versioning">the relevant section of CONTRIBUTING.md</a>.</p>
<p>Third-party packages are generally removed from typeshed when one of the following criteria is met:</p>
<ul>
<li>The upstream package ships a py.typed file for at least 6-12 months, or</li>
<li>the package does not support any of the Python versions supported by typeshed.</li>
</ul>
<h2 id="contributing">Contributing</h2>
<p>Please read <a href="CONTRIBUTING.md">CONTRIBUTING.md</a> before submitting pull requests. If you have questions related to contributing, drop by the <a href="https://gitter.im/python/typing">typing Gitter</a>.</p>
<h2 id="running-the-tests">Running the tests</h2>
<p>The tests are automatically run on every PR and push to the repo.</p>
<p>There are several tests: - <code>tests/mypy_test.py</code> tests typeshed with <a href="https://github.com/python/mypy/">mypy</a> - <code>tests/pytype_test.py</code> tests typeshed with <a href="https://github.com/google/pytype/">pytype</a>. - <code>tests/mypy_self_check.py</code> checks mypy's code base using this version of typeshed. - <code>tests/mypy_test_suite.py</code> runs a subset of mypy's test suite using this version of typeshed. - <code>tests/check_consistent.py</code> checks certain files in typeshed remain consistent with each other. - <code>tests/stubtest_test.py</code> checks stubs against the objects at runtime. - <code>flake8</code> enforces a style guide.</p>
<h3 id="setup">Setup</h3>
<p>Run:</p>
<pre><code>$ python3.6 -m venv .venv3
$ source .venv3/bin/activate
(.venv3)$ pip install -U pip
(.venv3)$ pip install -r requirements-tests-py3.txt</code></pre>
<p>This will install mypy (you need the latest master branch from GitHub), typed-ast, flake8 (and plugins), pytype, black and isort.</p>
<h3 id="mypy_test.py">mypy_test.py</h3>
<p>This test requires Python 3.6 or higher; Python 3.6.1 or higher is recommended. Run using:<code>(.venv3)$ python3 tests/mypy_test.py</code></p>
<p>This test is shallow — it verifies that all stubs can be imported but doesn't check whether stubs match their implementation (in the Python standard library or a third-party package). It has an exclude list of modules that are not tested at all, which also lives in the tests directory.</p>
<p>If you are in the typeshed repo that is submodule of the mypy repo (so <code>..</code> refers to the mypy repo), there's a shortcut to run the mypy tests that avoids installing mypy:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" title="1">$ <span class="va">PYTHONPATH=</span>../.. <span class="ex">python3</span> tests/mypy_test.py</a></code></pre></div>
<p>You can restrict mypy tests to a single version by passing <code>-p2</code> or <code>-p3.9</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" title="1">$ <span class="va">PYTHONPATH=</span>../.. <span class="ex">python3</span> tests/mypy_test.py -p3.9</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="ex">running</span> mypy --python-version 3.9 --strict-optional <span class="co"># with 342 files</span></a></code></pre></div>
<h3 id="pytype_test.py">pytype_test.py</h3>
<p>This test requires Python 2.7 and Python 3.6. Pytype will find these automatically if they're in <code>PATH</code>, but otherwise you must point to them with the <code>--python27-exe</code> and <code>--python36-exe</code> arguments, respectively. Run using: <code>(.venv3)$ python3 tests/pytype_test.py</code></p>
<p>This test works similarly to <code>mypy_test.py</code>, except it uses <code>pytype</code>.</p>
<h3 id="mypy_self_check.py">mypy_self_check.py</h3>
<p>This test requires Python 3.6 or higher; Python 3.6.1 or higher is recommended. Run using: <code>(.venv3)$ python3 tests/mypy_self_check.py</code></p>
<p>This test checks mypy's code base using mypy and typeshed code in this repo.</p>
<h3 id="mypy_test_suite.py">mypy_test_suite.py</h3>
<p>This test requires Python 3.5 or higher; Python 3.6.1 or higher is recommended. Run using: <code>(.venv3)$ python3 tests/mypy_test_suite.py</code></p>
<p>This test runs mypy's own test suite using the typeshed code in your repo. This will sometimes catch issues with incorrectly typed stubs, but is much slower than the other tests.</p>
<h3 id="check_consistent.py">check_consistent.py</h3>
<p>Run using: <code>python3 tests/check_consistent.py</code></p>
<h3 id="stubtest_test.py">stubtest_test.py</h3>
<p>This test requires Python 3.6 or higher. Run using <code>(.venv3)$ python3 tests/stubtest_test.py</code></p>
<p>This test compares the stdlib stubs against the objects at runtime. Because of this, the output depends on which version of Python and on what kind of system it is run. Thus the easiest way to run this test is via Github Actions on your fork; if you run it locally, it'll likely complain about system-specific differences (in e.g, <code>socket</code>) that the type system cannot capture. If you need a specific version of Python to repro a CI failure, <a href="https://github.com/pyenv/pyenv">pyenv</a> can help.</p>
<p>Due to its dynamic nature, you may run into false positives. In this case, you can add to the whitelists for each affected Python version in <code>tests/stubtest_whitelists</code>. Please file issues for stubtest false positives at <a href="https://github.com/python/mypy/issues">mypy</a>.</p>
<p>To run stubtest against third party stubs, it's easiest to use stubtest directly, with <code>(.venv3)$ python3 -m mypy.stubtest --custom-typeshed-dir &lt;path-to-typeshed&gt; &lt;third-party-module&gt;</code>. stubtest can also help you find things missing from the stubs.</p>
<h3 id="flake8">flake8</h3>
<p>flake8 requires Python 3.6 or higher. Run using: <code>(.venv3)$ flake8</code></p>
<p>Note typeshed uses the <code>flake8-pyi</code> and <code>flake8-bugbear</code> plugins.</p>
